
# 位操作符

## 特点和优劣
- JavaScript中所有数值都保存为双精度浮点数(64位)，但是做运算时会转换成单精度浮点数(32位)
- 位运算直接对二进制位进行计算，是底层的运算，优点是速度极快，缺点是不够直观
- 位运算只能对整数起作用，如果运算数不是整数，会自动转换成整数再运行

## 正负值
32位中最末位为符号位
求负值先获取反码再加1
```javascript
// 18的二进制: 00000000000000000000000000010010
// 18的反码的二进制: 11111111111111111111111111101101
// -18的二进制: 11111111111111111111111111101110
```

## 常用位运算符
### 按位非
~运算符: 求m二进制的反码，即-m-1
```javascript
// 25的二进制: 00000000000000000000000000011001
// 25的反码二进制: 11111111111111111111111111100110
// 25的反码: -26
```

### 按位与
&运算符: 对应的位都为1，则结果为1，否则为0
```javascript
// 25的二进制: 00000000000000000000000000011001
// 3的二进制: 00000000000000000000000000000011
// 25 & 3结果的二进制: 00000000000000000000000000000001
// 25 & 3结果: 1
```

### 按位或
|运算符: 对应的位只要有一个位为1，结果为1，否则为0
```javascript
// 25的二进制: 00000000000000000000000000011001
// 3的二进制: 00000000000000000000000000000011
// 25 | 3结果的二进制: 00000000000000000000000000011011
// 25 | 3结果: 27
```

### 按位异或
^运算符: 对应的位不同结果为1，否则为0
```javascript
// 25的二进制: 00000000000000000000000000011001
// 3的二进制: 00000000000000000000000000000011
// 25 ^ 3结果的二进制: 00000000000000000000000000011010
// 25 ^ 3结果: 26
```

### 有符号左移
<<运算符: 二进制所有的位都左移指定次数，高位移出舍弃，低位空位补0, 符号位不变
```javascript
// 25的二进制: 00000000000000000000000000011001
// 25 << 2结果的二进制: 00000000000000000000000001100100
// 25 << 2结果: 100
```

### 有符号右移
>>运算符: 二进制所有的位都右移指定次数，低位移出舍弃，高位空位补0, 符号位不变
```javascript
// 25的二进制: 00000000000000000000000000011001
// 25 >> 2结果的二进制: 00000000000000000000000000000110
// 25 >> 2结果: 6
```

### 无符号右移
>>>运算符: 二进制所有的位都右移指定次数，低位移除舍弃，高位空位补0，符号位补0
正值符号位为0，所有正值的>>>和>>等效, 负数符号为1，因为无符号位移后补0，则变成了正数
```javascript
// -18的二进制: 11111111111111111111111111101110
// -18 >>> 2结果的二进制: 00111111111111111111111111111011
// -18 >>> 2结果: 1073741819
```

## 常见位操作符使用
### 判断整数是偶数还是奇数
判断首位为1则为奇,为0则为偶
```javascript
// 25 & 1 == 1  //奇数
// 24 & 1 == 0  //偶数
```

### 将浮点型转换成整数
由于位操作符只能对整数起作用，以下运算都能将浮点型转换成整数，但是负浮点型的无符号右移会导致变成正值肯定改变了原整数值，所以不行
```javascript
// 3.2 | 0  //3
// 3.2 >> 0  //3
// 3.2 << 0 //3
// 3.2 ^ 0   //3
// 3.2 >>> 0  //3
// -3.2 >>> 0 //4294967293 不行
```

### 互换值
两个值a,b执行按位异或后的结果与其中任一值a执行按异或得到结果就是另一个值b， 再把初次合并的结果与初始b的值按位异后获取初始a的值
```javascript
let a = 4, b = 5;
a ^= b;
b ^= a;
a ^= b;
console.log(a);
console.log(b);
```

### hex与rgb颜色转换
hex是以冒号开头，内容是十六进制码，rgb是内容是由红，蓝，绿3个十进制组成。hex转换rgb就是要取前24位，将以8比特为单位分为3份，并将每部分移至最低位进行换算成十进制。rgb转换hex即将每部分内容十进制换算二进制并无符号向左移对应的次数并加上#
```javascript
function hexToRgb(hex) {
    let hexx = hex.replace('#', '0x');
    let r = hexx >> 16;
    let b = hexx >> 8 && 0xff;
    let g = hexx && 0xff;
    return `rgba(${r}, ${b}, '${g}')`;
}

function rgbToHex(rgb) {
    let rgbArr = rgb.split(/[^\d]+/);
    let color = rgbArr[1] << 16 | rgbArr[2] << 8 | rgbArr[3]
    return `#${color.toString(16)}`;
}
```


